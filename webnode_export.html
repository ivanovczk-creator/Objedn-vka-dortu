<!-- TENTO KÓD VLOŽTE DO "HTML" WIDGETU NA WEBNODE -->

<!-- 1. Načtení stylů a knihoven -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: {
          serif: ['"Playfair Display"', 'serif'],
          sans: ['"Lato"', 'sans-serif'],
        },
        colors: {
          brand: {
            50: '#fdf2f8', 100: '#fce7f3', 200: '#fbcfe8', 300: '#f9a8d4',
            400: '#f472b6', 500: '#ec4899', 600: '#db2777', 800: '#9d174d', 900: '#831843',
          }
        }
      }
    }
  }
</script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
  /* Lokální styly pro aplikaci */
  #cake-app-root ::-webkit-scrollbar { width: 8px; }
  #cake-app-root ::-webkit-scrollbar-track { background: #fdf2f8; }
  #cake-app-root ::-webkit-scrollbar-thumb { background: #f9a8d4; border-radius: 4px; }
  #cake-app-root .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>

<!-- 2. Nastavení importů pro React -->
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "@google/genai": "https://esm.sh/@google/genai@0.1.1",
    "lucide-react": "https://esm.sh/lucide-react@0.300.0"
  }
}
</script>

<!-- 3. Kontejner pro aplikaci -->
<div id="cake-app-root" class="bg-brand-50 text-gray-800 antialiased font-sans p-4 rounded-xl min-h-[600px]">
  <div style="text-align: center; padding: 40px; color: #db2777;">
    <svg class="animate-spin h-8 w-8 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
    Načítám poptávkový formulář...
  </div>
</div>

<!-- 4. Hlavní logika aplikace -->
<script type="text/babel" data-type="module">
    import React, { useState, useEffect, useMemo } from 'react';
    import ReactDOM from 'react-dom/client';
    import { GoogleGenAI } from '@google/genai';
    import { Camera, MapPin, Calendar as CalendarIcon, Loader2, CheckCircle2, ChevronLeft, ChevronRight, Upload, X, Plus, Mail, Phone, User, Printer } from 'lucide-react';

    // --- ZDE VLOŽTE VÁŠ API KLÍČ ---
    const API_KEY = "AIzaSyBBLCD7k1lgljXCR6nPrylGnsoOdT1qqqI"; 

    // --- DEFINICE DAT ---
    const CakeShape = { ROUND: 'Kulatý', RECTANGLE: 'Obdélník', SQUARE: 'Čtverec', HEART: 'Srdíčko' };
    const FillingType = { RASPBERRY: 'Malinová', CHOCOLATE: 'Čokoládová', CHERRY: 'Višňová', BLUEBERRY: 'Borůvková', PISTACHIO: 'Pistáciová', WALNUT: 'Ořechová', APRICOT: 'Meruňková', MANGO_PASSION: 'Mango-maracuja', VANILLA: 'Vanilková' };
    const SpongeType = { CHOCOLATE: 'Čokoládový', VANILLA: 'Vanilkový', WALNUT: 'Ořechový', MOSS: 'Mechový', RED_VELVET: 'Red-Velvet' };
    const SurfaceType = { CREAM: 'Krémový', CREAM_DRIP: 'Krémový a stékaná čokoláda', MARZIPAN: 'Marcipánový', CHOCO_SHAVINGS: 'Čoko-hobliny', EDIBLE_PRINT: 'Jedlý tisk', OTHER: 'Jiné' };

    const LOCATIONS = [
      { id: 'petrvald', name: 'Petřvald', address: 'Šenovská 1', phone: '778 157 857', type: 'store' },
      { id: 'karvina', name: 'Karviná', address: 'Tř. Těreškovové 2233/28', phone: '778 157 867', type: 'store' },
      { id: 'ostrava', name: 'Ostrava Zábřeh', address: 'Výškovická 116A', phone: '775 271 101', type: 'store' },
      { id: 'pist', name: 'Píšť (Výrobna)', address: 'Opavská 218/101', phone: '602 323 788', type: 'factory' }
    ];

    const CZECH_HOLIDAYS = ["01-01", "01-05", "08-05", "05-07", "06-07", "28-09", "28-10", "17-11", "24-12", "25-12", "26-12"];
    const CAKE_COLORS = [
      { name: 'Bílá', hex: '#FFFFFF' }, { name: 'Šedá', hex: '#9CA3AF' }, { name: 'Černá', hex: '#000000' },
      { name: 'Růžová', hex: '#F472B6' }, { name: 'Červená', hex: '#EF4444' }, { name: 'Hnědá', hex: '#854d0e' },
      { name: 'Oranžová', hex: '#F97316' }, { name: 'Modrá', hex: '#3B82F6' }, { name: 'Fialová', hex: '#A855F7' },
      { name: 'Zelená', hex: '#22C55E' }, { name: 'Žlutá', hex: '#EAB308' },
    ];
    const SHAVINGS_OPTIONS = ["Bílá", "Hnědá", "Růžová"];
    const DRIP_OPTIONS = ["Tmavá čokoláda", "Bílá čokoláda"];
    const ROUND_SIZES = ["26", "24", "22", "18", "16", "14"]; 
    const SQUARE_SIZES = ["28", "24", "20", "16"];
    const RECTANGLE_SIZES = ["60x40", "40x30", "Jiné"];
    const HEART_SIZES = ["24", "18", "16"];

    // --- FUNKCE AI ---
    const fileToGenerativePart = async (file) => {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result.split(',')[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    };

    const analyzeCakeImage = async (file) => {
      try {
        if (!API_KEY || API_KEY.includes("ZDE_VLOZTE")) { console.warn("API Key missing"); return {}; }
        const ai = new GoogleGenAI({ apiKey: API_KEY });
        const base64Data = await fileToGenerativePart(file);
        const prompt = "Analyze this cake image for a custom order form. 1. Identify shape (Round, Rectangle, Square, Heart). 2. Identify dominant color hex. 3. Write a short poetic description in Czech. Return JSON.";
        
        const response = await ai.models.generateContent({
          model: "gemini-2.5-flash",
          contents: { parts: [{ inlineData: { mimeType: file.type, data: base64Data } }, { text: prompt }] },
          config: { responseMimeType: "application/json" }
        });
        
        const data = JSON.parse(response.text());
        let mapShape = undefined;
        if (data.shape === "Round") mapShape = CakeShape.ROUND;
        if (data.shape === "Rectangle") mapShape = CakeShape.RECTANGLE;
        if (data.shape === "Square") mapShape = CakeShape.SQUARE;
        if (data.shape === "Heart") mapShape = CakeShape.HEART;
        
        return { suggestedShape: mapShape, suggestedColor: data.hexColor, description: data.description };
      } catch (e) { console.error(e); return {}; }
    };

    // --- KOMPONENTY ---
    const Steps = ({ currentStep, totalSteps }) => (
      <div className="w-full py-6">
        <div className="flex items-center justify-center space-x-2">
          {Array.from({ length: totalSteps }).map((_, idx) => {
            const stepNum = idx + 1;
            const isActive = stepNum === currentStep;
            const isCompleted = stepNum < currentStep;
            return (
              <React.Fragment key={stepNum}>
                <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm transition-all duration-300 ${isActive ? 'bg-brand-600 text-white scale-110 shadow-lg' : isCompleted ? 'bg-brand-300 text-brand-900' : 'bg-gray-200 text-gray-400'}`}>
                  {isCompleted ? '✓' : stepNum}
                </div>
                {stepNum < totalSteps && <div className={`h-1 w-8 sm:w-16 rounded transition-all duration-300 ${isCompleted ? 'bg-brand-300' : 'bg-gray-200'}`} />}
              </React.Fragment>
            );
          })}
        </div>
        <div className="text-center mt-2 text-brand-800 font-serif font-medium">
          {currentStep === 1 && "Předloha a Základ"} {currentStep === 2 && "Příchuť a Vzhled"}
          {currentStep === 3 && "Detaily"} {currentStep === 4 && "Vyzvednutí"} {currentStep === 5 && "Souhrn"}
        </div>
      </div>
    );

    const Calendar = ({ selectedDate, onSelect }) => {
      const [viewDate, setViewDate] = useState(new Date());
      const minDate = useMemo(() => { const d = new Date(); d.setDate(d.getDate() + 7); d.setHours(0,0,0,0); return d; }, []);
      
      const getDaysInMonth = (y, m) => new Date(y, m + 1, 0).getDate();
      const isHoliday = (d) => CZECH_HOLIDAYS.includes(`${String(d.getDate()).padStart(2,'0')}-${String(d.getMonth()+1).padStart(2,'0')}`);
      const isDisabled = (d) => d < minDate || isHoliday(d);
      
      const renderDays = () => {
        const y = viewDate.getFullYear(), m = viewDate.getMonth();
        const days = [], firstDay = new Date(y, m, 1).getDay();
        for(let i=0; i<firstDay; i++) days.push(<div key={`e-${i}`} />);
        for(let d=1; d<=getDaysInMonth(y, m); d++) {
          const curr = new Date(y, m, d);
          const disabled = isDisabled(curr);
          const sel = selectedDate && selectedDate.toDateString() === curr.toDateString();
          days.push(
            <button key={d} disabled={disabled} onClick={() => onSelect(curr)} className={`p-2 rounded-lg text-sm font-medium ${sel ? 'bg-brand-600 text-white' : disabled ? 'text-gray-300 cursor-not-allowed' : 'hover:bg-brand-100'}`}>
              {d}
            </button>
          );
        }
        return days;
      };

      return (
        <div className="bg-white p-4 rounded-xl shadow border border-brand-100 max-w-sm mx-auto">
          <div className="flex justify-between mb-4 font-bold text-brand-900">
            <button onClick={() => setViewDate(new Date(viewDate.setMonth(viewDate.getMonth()-1)))}>&lt;</button>
            <span>{viewDate.toLocaleString('cs-CZ', { month: 'long', year: 'numeric' })}</span>
            <button onClick={() => setViewDate(new Date(viewDate.setMonth(viewDate.getMonth()+1)))}>&gt;</button>
          </div>
          <div className="grid grid-cols-7 gap-1 text-center font-bold text-xs text-gray-500 mb-2">{["Ne","Po","Út","St","Čt","Pá","So"].map(d=><div key={d}>{d}</div>)}</div>
          <div className="grid grid-cols-7 gap-1">{renderDays()}</div>
          <div className="mt-2 text-xs text-gray-500 text-center">* Min. 7 dní na přípravu</div>
        </div>
      );
    };

    // --- HLAVNÍ APLIKACE ---
    function App() {
      const [step, setStep] = useState(1);
      const [order, setOrder] = useState({
        tiers: 1, tierSizes: ["24"], shape: CakeShape.ROUND, filling: FillingType.RASPBERRY, sponge: SpongeType.VANILLA,
        surface: SurfaceType.CREAM, inscription: '', specifications: '', quantity: 1, pickupDate: null, pickupLocationId: 'petrvald',
        images: [], customerName: '', customerEmail: '', customerPhone: ''
      });
      const [isAnalyzing, setIsAnalyzing] = useState(false);
      const [aiResult, setAiResult] = useState(null);

      const updateOrder = (upd) => setOrder(prev => ({ ...prev, ...upd }));
      
      const handleFileChange = async (e) => {
        if (!e.target.files?.length) return;
        const newFiles = Array.from(e.target.files).slice(0, 5 - order.images.length);
        const newImgs = newFiles.map(f => ({ id: Math.random().toString(36).substring(7), file: f, previewUrl: URL.createObjectURL(f) }));
        setOrder(prev => ({ ...prev, images: [...prev.images, ...newImgs] }));
        
        if (newImgs.length && !isAnalyzing) {
          setIsAnalyzing(true);
          const res = await analyzeCakeImage(newImgs[0].file);
          if (res.description) setAiResult(res.description);
          if (res.suggestedShape) handleShapeChange(res.suggestedShape);
          setIsAnalyzing(false);
        }
        e.target.value = '';
      };

      const handleEdiblePrintUpload = (e) => {
         if (e.target.files?.[0]) {
            const f = e.target.files[0];
            setOrder(p => ({ ...p, ediblePrintImage: { id: Math.random(), file: f, previewUrl: URL.createObjectURL(f) } }));
         }
      };

      const handleShapeChange = (shape) => {
         let sizes = shape === CakeShape.ROUND ? ROUND_SIZES : shape === CakeShape.SQUARE ? SQUARE_SIZES : shape === CakeShape.RECTANGLE ? RECTANGLE_SIZES : HEART_SIZES;
         setOrder(p => ({ ...p, shape, tierSizes: Array(p.tiers).fill(sizes[0]), customSizeNote: '' }));
      };

      const getSizes = (idx) => {
         let opts = order.shape === CakeShape.ROUND ? ROUND_SIZES : order.shape === CakeShape.SQUARE ? SQUARE_SIZES : order.shape === CakeShape.RECTANGLE ? RECTANGLE_SIZES : HEART_SIZES;
         if (idx === 0 || order.shape === CakeShape.RECTANGLE) return opts;
         const prev = parseInt(order.tierSizes[idx-1]);
         return opts.filter(s => parseInt(s) < prev);
      };

      const isStepValid = () => {
        if (step === 2) {
           if (!order.filling || !order.sponge || !order.surface) return false;
           if (order.surface === SurfaceType.MARZIPAN && !order.marzipanColor) return false;
           if (order.surface === SurfaceType.CREAM && !order.creamColor) return false;
           if (order.surface === SurfaceType.CREAM_DRIP && (!order.creamColor || !order.dripType)) return false;
           if (order.surface === SurfaceType.CHOCO_SHAVINGS && !order.shavingsType) return false;
           if (order.surface === SurfaceType.EDIBLE_PRINT && !order.ediblePrintImage) return false;
        }
        if (step === 4 && !order.pickupDate) return false;
        return true;
      };

      const submit = () => {
        let sd = order.surface;
        if (order.surface === SurfaceType.MARZIPAN) sd += ` (${order.marzipanColor})`;
        if (order.surface === SurfaceType.CREAM) sd += ` (${order.creamColor})`;
        if (order.surface === SurfaceType.CREAM_DRIP) sd += ` (Krém: ${order.creamColor}, Drip: ${order.dripType})`;
        if (order.surface === SurfaceType.CHOCO_SHAVINGS) sd += ` (${order.shavingsType})`;
        if (order.surface === SurfaceType.EDIBLE_PRINT) sd += ` (TISK Z PŘÍLOHY)`;
        
        const body = `POPTÁVKA DORTU\nKlient: ${order.customerName}, Tel: ${order.customerPhone}, Email: ${order.customerEmail}\n\nVyzvednutí: ${order.pickupDate?.toLocaleDateString()} - ${LOCATIONS.find(l=>l.id===order.pickupLocationId)?.name}\n\nDORT:\nTvar: ${order.shape} (${order.tiers}p)\nRozměry: ${order.tierSizes.join('/')} ${order.customSizeNote||''}\nKorpus: ${order.sponge}, Náplň: ${order.filling}\nPovrch: ${sd} ${order.surfaceOtherNote||''}\nNápis: ${order.inscription}\nPozn: ${order.specifications}`;
        window.location.href = `mailto:cukrarna.pist@seznam.cz?subject=Poptávka dortu - ${order.customerName}&body=${encodeURIComponent(body)}`;
      };

      const renderNav = () => (
         <div className="flex justify-between mt-6 pt-4 border-t">
           <button onClick={() => setStep(s => Math.max(1, s-1))} disabled={step===1} className="px-4 py-2 rounded text-gray-600 bg-gray-100 disabled:opacity-50">Zpět</button>
           {step < 5 
             ? <button onClick={() => isStepValid() && setStep(s => s+1)} disabled={!isStepValid()} className="px-6 py-2 rounded bg-brand-600 text-white font-bold disabled:opacity-50">Pokračovat</button>
             : <button onClick={submit} disabled={!order.customerName} className="px-6 py-2 rounded bg-green-600 text-white font-bold disabled:opacity-50">Odeslat poptávku</button>
           }
         </div>
      );

      return (
        <div className="max-w-4xl mx-auto">
          <div className="flex items-center justify-between mb-6 pb-4 border-b border-brand-100">
             <h1 className="font-serif text-2xl font-bold text-brand-800">Poptávka dortu</h1>
             <span className="text-xs font-bold text-brand-400 tracking-widest uppercase">Cukrářství Blahutovi</span>
          </div>

          <Steps currentStep={step} totalSteps={5} />
          
          <div className="mt-6 bg-white p-6 rounded-2xl shadow-sm border border-brand-100 min-h-[400px]">
             {step === 1 && (
               <div className="space-y-6">
                 <div>
                    <h2 className="text-xl font-bold mb-4 flex items-center"><Camera className="mr-2 text-brand-500"/> Předloha</h2>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                       {order.images.map(img => (
                          <div key={img.id} className="relative aspect-square"><img src={img.previewUrl} className="w-full h-full object-cover rounded-lg" /><button onClick={()=>setOrder(p=>({...p, images: p.images.filter(i=>i.id!==img.id)}))} className="absolute top-1 right-1 bg-white rounded-full p-1"><X size={14}/></button></div>
                       ))}
                       {order.images.length < 5 && <label className="aspect-square border-2 border-dashed border-brand-200 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:bg-brand-50 text-brand-400"><Plus/><span className="text-xs mt-1">Nahrát</span><input type="file" hidden multiple onChange={handleFileChange}/></label>}
                    </div>
                    {isAnalyzing && <div className="mt-2 text-sm text-brand-500 flex items-center"><Loader2 className="animate-spin mr-2 h-4 w-4"/> Analyzuji dort...</div>}
                    {aiResult && <div className="mt-2 text-sm italic text-gray-600 bg-brand-50 p-2 rounded">"{aiResult}"</div>}
                 </div>
                 <hr className="border-brand-100" />
                 <div>
                    <h2 className="text-xl font-bold mb-4">Tvar a Velikost</h2>
                    <div className="flex gap-2 overflow-x-auto pb-2 mb-4">{Object.values(CakeShape).map(s => <button key={s} onClick={()=>handleShapeChange(s)} className={`px-4 py-2 rounded-lg border whitespace-nowrap ${order.shape===s?'bg-brand-600 text-white':'bg-white text-gray-700'}`}>{s}</button>)}</div>
                    <div className="flex gap-4 items-center mb-4">
                       <span className="text-sm font-bold">Patra:</span>
                       {[1,2,3].map(n => <button key={n} onClick={()=>{const sz=Array(n).fill(getSizes(0)[0]); setOrder(p=>({...p, tiers:n, tierSizes:sz}))}} className={`w-10 h-10 rounded-lg font-bold ${order.tiers===n?'bg-brand-100 text-brand-800 border-2 border-brand-500':'bg-gray-50 border'}`}>{n}</button>)}
                    </div>
                    <div className="space-y-2">
                       {order.tierSizes.map((sz, i) => (
                          <div key={i} className="flex items-center gap-2">
                             <span className="text-sm w-20">{i+1}. patro:</span>
                             <select value={sz} onChange={(e)=>{const n=[...order.tierSizes]; n[i]=e.target.value; setOrder(p=>({...p, tierSizes:n}))}} className="p-2 border rounded flex-1">{getSizes(i).map(s=><option key={s} value={s}>{s} cm</option>)}</select>
                             {order.shape===CakeShape.RECTANGLE && sz==='Jiné' && <input placeholder="Rozměr" value={order.customSizeNote||''} onChange={e=>updateOrder({customSizeNote:e.target.value})} className="p-2 border rounded flex-1"/>}
                          </div>
                       ))}
                    </div>
                 </div>
               </div>
             )}

             {step === 2 && (
               <div className="space-y-6">
                 <h2 className="text-xl font-bold flex items-center">Příchuť a Vzhled</h2>
                 <div className="grid md:grid-cols-2 gap-4">
                    <label className="block text-sm font-bold">Náplň<select value={order.filling} onChange={e=>updateOrder({filling:e.target.value})} className="w-full p-2 border rounded mt-1">{Object.values(FillingType).map(v=><option key={v} value={v}>{v}</option>)}</select></label>
                    <label className="block text-sm font-bold">Korpus<select value={order.sponge} onChange={e=>updateOrder({sponge:e.target.value})} className="w-full p-2 border rounded mt-1">{Object.values(SpongeType).map(v=><option key={v} value={v}>{v}</option>)}</select></label>
                 </div>
                 <div>
                    <label className="block text-sm font-bold mb-2">Povrch</label>
                    <div className="grid grid-cols-2 gap-2">{Object.values(SurfaceType).map(s=><label key={s} className={`p-3 border rounded cursor-pointer flex items-center text-sm ${order.surface===s?'bg-brand-50 border-brand-500':''}`}><input type="radio" checked={order.surface===s} onChange={()=>updateOrder({surface:s})} className="mr-2"/>{s}</label>)}</div>
                 </div>
                 
                 {/* Detail Colors */}
                 {(order.surface === SurfaceType.MARZIPAN || order.surface === SurfaceType.CREAM || order.surface === SurfaceType.CREAM_DRIP) && (
                    <div className="bg-brand-50 p-4 rounded">
                       <span className="text-sm font-bold block mb-2">Barva {order.surface===SurfaceType.MARZIPAN?'marcipánu':'krému'}:</span>
                       <div className="flex flex-wrap gap-2">{CAKE_COLORS.map(c=><button key={c.name} onClick={()=>updateOrder(order.surface===SurfaceType.MARZIPAN?{marzipanColor:c.name}:{creamColor:c.name})} className={`w-8 h-8 rounded-full border-2 ${order[order.surface===SurfaceType.MARZIPAN?'marzipanColor':'creamColor']===c.name?'border-black scale-110':'border-transparent'}`} style={{backgroundColor:c.hex}} title={c.name}/>)}</div>
                    </div>
                 )}
                 {order.surface === SurfaceType.CREAM_DRIP && (
                    <div className="bg-brand-50 p-4 rounded mt-2"><span className="text-sm font-bold block mb-2">Druh stékání:</span><div className="flex gap-4">{DRIP_OPTIONS.map(o=><label key={o} className="flex items-center text-sm"><input type="radio" checked={order.dripType===o} onChange={()=>updateOrder({dripType:o})} className="mr-1"/>{o}</label>)}</div></div>
                 )}
                 {order.surface === SurfaceType.CHOCO_SHAVINGS && (
                    <div className="bg-brand-50 p-4 rounded mt-2"><span className="text-sm font-bold block mb-2">Barva hoblin:</span><div className="flex gap-4">{SHAVINGS_OPTIONS.map(o=><label key={o} className="flex items-center text-sm"><input type="radio" checked={order.shavingsType===o} onChange={()=>updateOrder({shavingsType:o})} className="mr-1"/>{o}</label>)}</div></div>
                 )}
                 {order.surface === SurfaceType.EDIBLE_PRINT && (
                    <div className="bg-brand-50 p-4 rounded mt-2 text-center">
                       <span className="text-sm font-bold block mb-2">Nahrát obrázek pro tisk</span>
                       {!order.ediblePrintImage ? <input type="file" accept="image/*" onChange={handleEdiblePrintUpload} /> : <div className="text-green-600 text-sm font-bold">✓ Obrázek nahrán</div>}
                    </div>
                 )}
               </div>
             )}

             {step === 3 && (
                <div className="space-y-6">
                   <h2 className="text-xl font-bold">Detaily</h2>
                   <label className="block text-sm font-bold">Nápis na dort<input value={order.inscription} onChange={e=>updateOrder({inscription:e.target.value})} className="w-full p-2 border rounded mt-1" placeholder="Všechno nejlepší..."/></label>
                   <label className="block text-sm font-bold">Další specifikace<textarea value={order.specifications} onChange={e=>updateOrder({specifications:e.target.value})} className="w-full p-2 border rounded mt-1" rows="3" placeholder="Alergie, zdobení..."/></label>
                   <div className="flex items-center gap-4"><span className="font-bold">Množství:</span><button onClick={()=>updateOrder({quantity:Math.max(1,order.quantity-1)})} className="w-8 h-8 bg-gray-200 rounded">-</button><span>{order.quantity} ks</span><button onClick={()=>updateOrder({quantity:order.quantity+1})} className="w-8 h-8 bg-gray-200 rounded">+</button></div>
                </div>
             )}

             {step === 4 && (
                <div className="grid md:grid-cols-2 gap-6">
                   <div><h2 className="text-xl font-bold mb-4 flex items-center"><CalendarIcon className="mr-2 text-brand-500"/> Datum</h2><Calendar selectedDate={order.pickupDate} onSelect={d=>updateOrder({pickupDate:d})} /></div>
                   <div><h2 className="text-xl font-bold mb-4 flex items-center"><MapPin className="mr-2 text-brand-500"/> Místo</h2><div className="space-y-2">{LOCATIONS.map(l=><button key={l.id} onClick={()=>updateOrder({pickupLocationId:l.id})} className={`w-full text-left p-3 rounded border ${order.pickupLocationId===l.id?'border-brand-500 bg-brand-50':''}`}><div className="font-bold">{l.name}</div><div className="text-xs">{l.address}</div></button>)}</div></div>
                </div>
             )}

             {step === 5 && (
                <div className="space-y-6">
                   <h2 className="text-xl font-bold flex items-center"><User className="mr-2 text-brand-500"/> Kontaktní údaje</h2>
                   <div className="grid gap-4">
                      <input placeholder="Jméno a příjmení" value={order.customerName} onChange={e=>updateOrder({customerName:e.target.value})} className="p-3 border rounded"/>
                      <div className="grid grid-cols-2 gap-4"><input placeholder="Telefon" value={order.customerPhone} onChange={e=>updateOrder({customerPhone:e.target.value})} className="p-3 border rounded"/><input placeholder="Email" value={order.customerEmail} onChange={e=>updateOrder({customerEmail:e.target.value})} className="p-3 border rounded"/></div>
                   </div>
                   <div className="bg-brand-50 p-4 rounded text-sm space-y-2 border border-brand-200">
                      <h3 className="font-bold text-lg text-brand-800 border-b border-brand-200 pb-2 mb-2">Souhrn</h3>
                      <div className="flex justify-between"><span>Dort:</span> <span className="font-bold">{order.shape}, {order.tiers} patra</span></div>
                      <div className="flex justify-between"><span>Příchuť:</span> <span>{order.filling}, {order.sponge}</span></div>
                      <div className="flex justify-between"><span>Povrch:</span> <span className="font-bold">{order.surface}</span></div>
                      <div className="flex justify-between"><span>Vyzvednutí:</span> <span>{order.pickupDate?.toLocaleDateString()} ({LOCATIONS.find(l=>l.id===order.pickupLocationId)?.name})</span></div>
                      {order.surface === SurfaceType.EDIBLE_PRINT && <div className="text-red-500 font-bold text-center pt-2">! Nezapomeňte odeslat obrázek !</div>}
                   </div>
                </div>
             )}
             
             {renderNav()}
          </div>
        </div>
      );
    }

    // Spuštění React aplikace
    const rootElement = document.getElementById('cake-app-root');
    const root = ReactDOM.createRoot(rootElement);
    root.render(<App />);
</script>